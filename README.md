# Справочник сотрудников

## Установка

1. Установите  poetry
	```
	curl -sSL https://install.python-poetry.org | python3 -
	```
2. Клонируйте репозиторий 
	```
	git clone https://github.com/neojelll/task-PTMK
	```
3. Перейдите в директорию проекта:
   ```
   cd app
   ```
4. Установите зависимости
	```
	poetry install
	```
5. Запустите докер контейнер с базой данных
	```
	docker run --name my-postgres \ 
	-p 5432:5432 \
	-e POSTGRES_USER=<your-username> \
	-e POSTGRES_PASSWORD=<your-password> \
	-e POSTGRES_DB=<your-database-name> \
	-v pgdata:/var/lib/postgresql/data \
	-d postgres	
	```
6. Установите переменную окружения с ссылкой на базу данных
	```
	export DB_URL=postgresql:/<your-username>:<your-password>@localhost:5432/<your-database-name>
	```
7. Чтобы узнать о доступных командах и параметрах, выполните:
	```
	poetry run app -h

	usage: app [-h] {1,2,3,4,5,6} ...

	Employee Management Application

	positional arguments:
  	{1,2,3,4,5,6}
    	1            Create employee table
    	2            Add an employee
    	3            List all employees
    	4            Generate test employees
    	5            Query male employees
    	6            Optimize and query male employees

	options:
  	-h, --help     show this help message and exit
	```

## Use Cases

### UC 1: Создание таблицы сотрудников 

Описание: Пользователь запускает приложение для создания таблицы сотрудников в PostgreSQL.

* Действия: Пользователь запускает приложение с параметром `1` (например: `poetry run app 1`).

* Результат: Таблица `employees` создается в базе данных с необходимыми полями (ФИО, дата рождения, пол).

### UC 2: Добавление нового сотрудника

Описание: Пользователь добавляет нового сотрудника в справочник.

* Предусловия: Таблица должна быть создана (UC1).

* Действия: пользователь запускает приложение с параметром `2` и передает ФИО, дату рождение и пол (например, `poetry run app 2 "Ivanov Petr Sergeevich" 2009-07-12 Male`).

* Результат: Новый сотрудник добавляется в таблицу `employees`, и данные сохраняются в базе данных.

### UC 3: Вывод всех сотрудников

* Описание: Пользователь хочет просмотреть список всех сотрудников в справочнике.

* Предусловия: Таблица сотрудников должна содержать данные (должен быть добавлен хотя бы один сотрудник).

* Действия: Пользователь запускает приложение с параметром `3` (например, `poetry run app 3`).

* Результат: Приложение выводит список сотрудников с ФИО, датой рождения, полом и количеством полных лет, отсортированным по ФИО.

### UC 4: Автоматическое заполнение базы данных

* Описание: Пользователь хочет заполнить таблицу сотрудников тестовыми данными.

* Предусловия: Таблица сотрудников должна быть создана.

* Действия: Пользователь запускает приложение с параметром `4` (например, `poetry run app 4`).

* Результат: В таблицу `employees` автоматически добавляется 1,000,000 записей с сгенерированными данными, а также 100 записей с мужскими именами, начинающимися с "F".

### UC 5: Фильтрация сотрудников по критериям

* Описание: пользователь хочет увидеть всех мужчин с фамилией, начинающейся на "F".

* Предусловия: Таблица сотрудников должна содержать данные.

* Действия: Пользователь запускает приложение с параметром `5` (например, `poetry run app 5`).

* Результат: Приложение выводит список сотрудников, соответствующих критериям, и время, затраченное на выполнение запроса.

### UC 6: Оптимизация базы данных

* Описание: Пользователь хочет оптимизировать базу данных для ускорения выборки данных.

* Предусловия: Таблица сотрудников должна содержать данные.

* Действия: Пользователь запускает приложение с параметром `6` (например, `poetry run app 6`).

* Результат: Создаются индексы на полях `gender` и `full_name`, что должно ускорить выполнение запросов. Пользователь может затем повторно запустить юзкейс 5 и сравнить время выполнения.
